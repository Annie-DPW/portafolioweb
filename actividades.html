<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Administrador de Proyectos</title>
  <link rel="stylesheet" href="css/actividades.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <div class="container my-5">
    <h1 class="text-center mb-4">Panel de Administraci√≥n</h1>
    <div class="text-center mb-4">
      <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#uploadModal">‚ûï Subir Proyecto</button>
    </div>

    <!-- Modal para subir archivo -->
    <div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-danger text-white">
            <h5 class="modal-title">Subir Nuevo Proyecto</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Nombre del proyecto</label>
              <input type="text" id="projectName" class="form-control" placeholder="Ingresa el nombre del proyecto" />
            </div>
            <div class="mb-3">
              <label class="form-label">Descripci√≥n</label>
              <textarea id="projectDesc" class="form-control" rows="3" placeholder="Breve descripci√≥n"></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Archivo PDF</label>
              <input type="file" id="projectFile" class="form-control" accept=".pdf" />
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button class="btn btn-danger" onclick="addProject()">Subir Proyecto</button>
          </div>
        </div>
      </div>
    </div>

    <div id="projectList" class="mt-5"></div>

    <section class="portafolio mt-5" id="portafolio">
      <div class="content-section">
        <h2 class="text-center"><span>Portafolio</span></h2>
        <p class="text-center">Estos son algunos de los proyectos subidos:</p>
        <div class="row" id="galeria"></div>
      </div>
    </section>
  </div>

  <script>
    let projects = [];

    window.addEventListener("load", () => {
      const stored = localStorage.getItem("projects");
      if (stored) {
        projects = JSON.parse(stored);
        renderProjects();
      }
    });

    function addProject() {
      const name = document.getElementById("projectName").value.trim();
      const desc = document.getElementById("projectDesc").value.trim();
      const file = document.getElementById("projectFile").files[0];

      if (!name || !desc || !file) {
        alert("Completa todos los campos y selecciona un archivo.");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const fileData = e.target.result;
        projects.push({ name, desc, fileData });
        saveProjects();
        renderProjects();
        resetForm();
        bootstrap.Modal.getInstance(document.getElementById("uploadModal")).hide();
      };
      reader.readAsDataURL(file);
    }

    function renderProjects() {
      const list = document.getElementById("projectList");
      const galeria = document.getElementById("galeria");
      list.innerHTML = '<h2>Proyectos Subidos</h2>';
      galeria.innerHTML = "";

      projects.forEach((project, index) => {
        // Vista admin
        list.innerHTML += `
          <div class="project mb-4 p-3 border rounded">
            <strong>${project.name}</strong>
            <p>${project.desc}</p>
            <a href="${project.fileData}" target="_blank" class="btn btn-sm btn-primary me-2">üìÑ Ver</a>
            <a href="${project.fileData}" download="${project.name}.pdf" class="btn btn-sm btn-success me-2">‚¨áÔ∏è Descargar</a>
            <button class="btn btn-sm btn-warning me-2" onclick="editProject(${index})">‚úèÔ∏è Editar</button>
            <button class="btn btn-sm btn-danger" onclick="deleteProject(${index})">üóëÔ∏è Eliminar</button>
          </div>
        `;

        // Vista galer√≠a (sin imagen de fondo)
        galeria.innerHTML += `
          <div class="col-md-4 mb-4">
            <a href="${project.fileData}" target="_blank" class="proyecto" style="background: #f8f9fa; border-radius: 10px; padding: 20px; text-decoration: none; display: block; box-shadow: 0 0 10px rgba(0,0,0,0.1); height: 100%;">
              <div class="overlay" style="position: static; background: none; color: #212529;">
                <h5 style="margin-bottom: 10px;">${project.name}</h5>
                <p>${project.desc}</p>
              </div>
            </a>
          </div>
        `;
      });
    }

    function editProject(index) {
      const project = projects[index];
      const newName = prompt("Nuevo nombre del proyecto:", project.name);
      const newDesc = prompt("Nueva descripci√≥n:", project.desc);
      if (newName && newDesc) {
        projects[index].name = newName;
        projects[index].desc = newDesc;
        saveProjects();
        renderProjects();
      }
    }

    function deleteProject(index) {
      if (confirm("¬øEst√°s seguro de eliminar este proyecto?")) {
        projects.splice(index, 1);
        saveProjects();
        renderProjects();
      }
    }

    function saveProjects() {
      localStorage.setItem("projects", JSON.stringify(projects));
    }

    function resetForm() {
      document.getElementById("projectName").value = "";
      document.getElementById("projectDesc").value = "";
      document.getElementById("projectFile").value = "";
    }
  </script>
</body>
</html>
